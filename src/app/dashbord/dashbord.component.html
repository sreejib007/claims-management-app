<div class="dashboard-container">
  <!-- Executive Summary Header -->
  <div class="executive-header">
    <div class="d-flex justify-content-between align-items-center">
      <div class="d-flex align-items-center gap-3">
        <div class="header-icon">
          <i class="pi pi-th-large"></i>
        </div>
        <div>
          <h4 class="mb-0 fw-bold text-white">Claims Dashboard</h4>
          <span class="header-subtitle">Real-time performance metrics</span>
        </div>
      </div>
      <div class="header-actions">
        <button class="action-btn" (click)="onNewClaimClick()">
          <i class="pi pi-plus"></i>
          <span>New Claim</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Metrics Grid -->
  <div class="metrics-section">
    <div class="row g-3">
      <div class="col-6 col-md-4 col-xl" *ngFor="let metric of metrics; let i = index">
        <app-metric-card
          [label]="metric.title"
          [value]="metric.value"
          [icon]="metric.icon"
          [iconBg]="metric.iconBg"
          [trend]="metric.trend || ''"
          [trendUp]="metric.trendUp || false"
          [colorVariant]="'variant-' + (i % 5)">
        </app-metric-card>
      </div>
    </div>
  </div>

  <!-- Charts Section -->
  <div class="charts-section">
    <!-- First Row: 3 Charts -->
    <div class="row g-2">
      <!-- Performance Radar Chart -->
      <div class="col-4">
        <div class="chart-card radar-card">
          <div class="chart-card-header compact">
            <h6 class="chart-title mb-0">Performance</h6>
          </div>
          <div class="chart-card-body compact">
            <div class="chart-container-radar-sm">
              <canvas #radarChart></canvas>
            </div>
          </div>
        </div>
      </div>

      <!-- Claims by Loss Type -->
      <div class="col-4">
        <div class="chart-card">
          <div class="chart-card-header compact">
            <h6 class="chart-title mb-0">By Loss Type</h6>
          </div>
          <div class="chart-card-body compact">
            <div class="d-flex align-items-center justify-content-between">
              <div class="chart-container-donut-legend">
                <canvas #lossTypeChart></canvas>
              </div>
              <div class="loss-type-legend">
                <div class="legend-row" *ngFor="let item of claimsByLossType; let i = index">
                  <span class="legend-dot-sm" [style.background]="['#f87171', '#fbbf24', '#60a5fa', '#f472b6', '#a78bfa'][i]"></span>
                  <span class="legend-text">{{ item.type }}</span>
                  <span class="legend-count">{{ item.count }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Financial Impact -->
      <div class="col-4">
        <div class="chart-card">
          <div class="chart-card-header compact">
            <h6 class="chart-title mb-0">Financial Impact</h6>
            <span class="chart-badge-sm danger">Â£ Priority</span>
          </div>
          <div class="chart-card-body compact">
            <div class="chart-container-bar-sm">
              <canvas #impactChart></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Second Row: Claims Pipeline Full Width -->
    <div class="row g-2 mt-2">
      <div class="col-12">
        <div class="chart-card pipeline-card-full">
          <div class="chart-card-header compact">
            <div class="d-flex align-items-center gap-2">
              <app-icon-box icon="pi pi-sitemap" size="sm" color="subtle-primary"></app-icon-box>
              <h6 class="chart-title mb-0">Claims Pipeline</h6>
            </div>
            <div class="pipeline-total-badge">{{ totalClaimsInPipeline }} Total</div>
          </div>
          <div class="chart-card-body pipeline-body">
            <div class="pipeline-row">
              <div class="pipeline-stage-card" *ngFor="let stage of claimsPipeline; let last = last">
                <div class="stage-progress-ring">
                  <svg viewBox="0 0 36 36">
                    <path class="ring-bg" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"/>
                    <path class="ring-progress"
                      [style.stroke]="stage.color"
                      [attr.stroke-dasharray]="stage.percentage + ', 100'"
                      d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"/>
                  </svg>
                  <span class="ring-percent" [style.color]="stage.color">{{ stage.percentage | number:'1.0-0' }}%</span>
                </div>
                <div class="stage-details">
                  <span class="stage-count-lg" [style.color]="stage.color">{{ stage.count }}</span>
                  <span class="stage-label">{{ stage.status }}</span>
                </div>
                <div class="stage-arrow" *ngIf="!last">
                  <i class="pi pi-arrow-right"></i>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
